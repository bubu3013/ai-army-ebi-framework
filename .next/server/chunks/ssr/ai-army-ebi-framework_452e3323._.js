module.exports=[73451,(a,b,c)=>{"use strict";b.exports=a.r(54750).vendored["react-ssr"].ReactDOM},36757,a=>{"use strict";var b=a.i(31706),c=a.i(184),d=a.i(67045),e=a.i(75721);let f=c.forwardRef(({className:a,type:c,...d},f)=>(0,b.jsx)("input",{type:c,className:(0,e.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:f,...d}));f.displayName="Input";var g=a.i(82151),h=a.i(26846),i=a.i(46365),j=a.i(3427),k=a.i(95344),l=a.i(30699),m=a.i(44553);let n=(0,m.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),o=(0,m.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),p=(0,m.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var q=a.i(43057);let r=`month,avg_temp_taipei,epidemic_index,gt_flu,gt_cold,gt_immunity,gt_competitor_total,has_bundle_promo,bundle_discount_rate,bundle_start_date,bundle_duration_days,has_bulk_promo,bulk_discount_rate,season_event_tag,historical_m1_month,historical_m1_qty,historical_m2_month,historical_m2_qty,historical_m3_month,historical_m3_qty
2025-11,18.5,45.2,62,55,48,120,true,0.30,2025-11-05,14,false,0,,2025-08,668,2025-09,316,2025-10,904`;function s({cat:a}){let c=q.CATEGORY_COLORS[a];return(0,b.jsx)(h.Badge,{variant:"outline",style:{color:c,borderColor:c},className:"font-semibold",children:a})}function t({label:a,value:c,color:d}){return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:a}),(0,b.jsxs)("span",{children:[(100*c).toFixed(0),"%"]})]}),(0,b.jsx)("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${100*c}%`,backgroundColor:d}})})]})}function u(){let[a,e]=(0,c.useState)("gpt-4o"),[m,u]=(0,c.useState)("vB"),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(null),J=(0,c.useRef)(null),K="gpt-4o"===a||"mini"===a,L="haiku"===a,M=K&&!v.trim()||L&&!x.trim(),N=async()=>{if(!B)return void G("Please select a CSV file.");if(M)return void G("Please enter the required API key.");E(!0),G(null),I(null);try{let b=(await B.text()).trim().split("\n");if(b.length<2)throw Error("CSV must have a header row and at least one data row.");let c=b[0].split(",").map(a=>a.trim()),d=b[1].split(",").map(a=>a.trim()),e=Object.fromEntries(c.map((a,b)=>[a,d[b]??""])),f=[];for(let a=1;a<=7;a++){let b=e[`historical_m${a}_month`],c=e[`historical_m${a}_qty`];b&&c&&f.push({month:b,qty:parseInt(c)})}let g={month:e.month,avg_temp_taipei:parseFloat(e.avg_temp_taipei),epidemic_index:parseFloat(e.epidemic_index),gt_flu:parseInt(e.gt_flu),gt_cold:parseInt(e.gt_cold),gt_immunity:parseInt(e.gt_immunity),gt_competitor_total:parseFloat(e.gt_competitor_total),has_bundle_promo:e.has_bundle_promo?.toLowerCase()==="true",bundle_discount_rate:parseFloat(e.bundle_discount_rate)||0,bundle_start_date:e.bundle_start_date||"",bundle_duration_days:parseInt(e.bundle_duration_days)||0,has_bulk_promo:e.has_bulk_promo?.toLowerCase()==="true",bulk_discount_rate:parseFloat(e.bulk_discount_rate)||0,season_event_tag:e.season_event_tag||"",historical_sales:f},h=await fetch("/api/health-predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({features:g,model:a,version:m,openai_api_key:K?v.trim():void 0,anthropic_api_key:L?x.trim():void 0})}),i=await h.json();if(!h.ok)throw Error(i.error??"Prediction failed");I(i.result)}catch(a){G(a instanceof Error?a.message:"Unknown error")}finally{E(!1)}};return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsxs)("main",{className:"container mx-auto px-4 py-6 space-y-6 max-w-3xl",children:[(0,b.jsxs)(g.Card,{className:"border-border",children:[(0,b.jsxs)(g.CardHeader,{className:"pb-4",children:[(0,b.jsx)(g.CardTitle,{className:"text-lg font-medium",children:"Upload & Predict"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload a month's feature CSV and get an instant L/M/H sales prediction. Your API key is sent directly to the provider and never stored."})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-5",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Model"}),(0,b.jsxs)(i.Select,{value:a,onValueChange:a=>e(a),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsx)(i.SelectContent,{children:q.MODELS.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Prompt Version"}),(0,b.jsxs)(i.Select,{value:m,onValueChange:a=>u(a),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsx)(i.SelectContent,{children:q.VERSIONS.map(a=>(0,b.jsxs)(i.SelectItem,{value:a.value,children:[a.label," — ",a.description]},a.value))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 p-4 rounded-lg border border-border bg-secondary/20",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-sm font-medium",children:["API Key ",K?"(OpenAI)":"(Anthropic)"]}),(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>A(!z),children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{className:"h-4 w-4 mr-1"})," Hide"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-1"})," Show"]})})]}),K&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"OpenAI API Key"}),(0,b.jsx)(f,{type:z?"text":"password",placeholder:"sk-...",value:v,onChange:a=>w(a.target.value)})]}),L&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Anthropic API Key"}),(0,b.jsx)(f,{type:z?"text":"password",placeholder:"sk-ant-...",value:x,onChange:a=>y(a.target.value)})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Key is forwarded directly to the provider. Not stored or logged."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Feature CSV"}),(0,b.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:()=>{let a=new Blob([r],{type:"text/csv"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="health_food_template.csv",c.click(),URL.revokeObjectURL(b)},children:[(0,b.jsx)(o,{className:"h-4 w-4 mr-1"})," Download Template"]})]}),(0,b.jsx)(f,{type:"file",accept:".csv",ref:J,onChange:a=>{a.target.files?.[0]&&C(a.target.files[0])}}),B&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Selected: ",B.name]})]}),(0,b.jsx)(d.Button,{className:"w-full",onClick:N,disabled:!B||D||M,children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Predicting…"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.UploadCloud,{className:"mr-2 h-4 w-4"})," Get Prediction"]})})]})]}),F&&(0,b.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-destructive/40 bg-destructive/5 text-destructive text-sm",children:[(0,b.jsx)(p,{className:"h-4 w-4 mt-0.5 shrink-0"}),(0,b.jsx)("span",{children:F})]}),D&&(0,b.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,b.jsx)(j.Loader2,{className:"h-8 w-8 animate-spin text-primary"}),(0,b.jsx)("span",{className:"ml-3 text-muted-foreground",children:"Generating prediction…"})]}),!D&&H&&(0,b.jsxs)(g.Card,{className:"border-border",children:[(0,b.jsx)(g.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(g.CardTitle,{className:"text-lg font-medium",children:"Prediction Result"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Badge,{variant:"secondary",children:q.MODELS.find(b=>b.value===a)?.label}),(0,b.jsx)(h.Badge,{variant:"outline",children:m})]})]})}),(0,b.jsxs)(g.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Predicted Sales Category"}),(0,b.jsx)(s,{cat:H.pred_class})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(t,{label:"P(Low)  — ≤ 363 bottles",value:H.prob_L,color:q.CATEGORY_COLORS.Low}),(0,b.jsx)(t,{label:"P(Mid)  — 364–446 bottles",value:H.prob_M,color:q.CATEGORY_COLORS.Mid}),(0,b.jsx)(t,{label:"P(High) — ≥ 447 bottles",value:H.prob_H,color:q.CATEGORY_COLORS.High})]}),H.step1_b&&(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-secondary/20 space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Step 1 Reasoning — Active Purchase Drivers [B]"}),(0,b.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:H.step1_b})]})]})]}),!D&&!H&&!F&&(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground text-sm",children:"Upload a CSV and click Get Prediction to see results here."})]}),(0,b.jsx)("footer",{className:"border-t border-border mt-8",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"AI-Army EBI Framework · Health Food Sales Prediction"})})})]})}a.s(["default",()=>u],36757)}];

//# sourceMappingURL=ai-army-ebi-framework_452e3323._.js.map